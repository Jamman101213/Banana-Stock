<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Banana Grower - Email Login</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6213603518465024"
       crossorigin="anonymous"></script>
  <style>
    body {
      background: linear-gradient(135deg, #fefae0 0%, #fff9c4 100%);
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .login-container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      text-align: center;
      max-width: 400px;
      width: 90%;
      border: 3px solid #ffecb3;
    }

    .welcome-header {
      color: #665c00;
      font-size: 3em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }

    .game-title {
      color: #a18800;
      font-size: 2.5em;
      margin-bottom: 20px;
      font-weight: bold;
    }

    .form-title {
      color: #665c00;
      font-size: 1.5em;
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }

    .form-group label {
      display: block;
      color: #665c00;
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 1.1em;
    }

    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #ffecb3;
      border-radius: 10px;
      font-size: 1em;
      background: #fff9c4;
      color: #665c00;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }

    .form-group input:focus {
      outline: none;
      border-color: #ffd54f;
      background: white;
      box-shadow: 0 0 10px rgba(255, 213, 79, 0.3);
    }

    .form-group input::placeholder {
      color: #a18800;
      opacity: 0.7;
    }

    .login-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 30px;
    }

    .btn {
      padding: 15px 30px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4fc3f7 0%, #81d4fa 100%);
      color: white;
      border-color: #4fc3f7;
      box-shadow: 0 4px 15px rgba(79, 195, 247, 0.4);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #29b6f6 0%, #4fc3f7 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(79, 195, 247, 0.6);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #ffd54f 0%, #ffe082 100%);
      color: #5d4037;
      border-color: #ffecb3;
      box-shadow: 0 4px 15px rgba(255, 213, 79, 0.4);
    }

    .btn-secondary:hover {
      background: linear-gradient(135deg, #ffe082 0%, #fff176 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 213, 79, 0.6);
    }

    .btn-back {
      background: linear-gradient(135deg, #9e9e9e 0%, #bdbdbd 100%);
      color: white;
      border-color: #9e9e9e;
      box-shadow: 0 4px 15px rgba(158, 158, 158, 0.4);
    }

    .btn-back:hover {
      background: linear-gradient(135deg, #757575 0%, #9e9e9e 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(158, 158, 158, 0.6);
    }

    .loading {
      display: none;
      color: #4fc3f7;
      font-size: 1.2em;
      margin-top: 20px;
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #4fc3f7;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .error-message {
      background: #ffebee;
      color: #c62828;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      border: 2px solid #ffcdd2;
      display: none;
    }

    .tab-container {
      display: flex;
      background: #fff9c4;
      border-radius: 15px;
      padding: 5px;
      margin-bottom: 30px;
    }

    .tab-button {
      flex: 1;
      padding: 12px;
      background: transparent;
      border: none;
      border-radius: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #a18800;
    }

    .tab-button.active {
      background: #ffd54f;
      color: #5d4037;
      box-shadow: 0 2px 8px rgba(255, 213, 79, 0.3);
    }

    .floating-banana {
      position: absolute;
      font-size: 2em;
      animation: float 3s ease-in-out infinite;
      opacity: 0.3;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }

    .banana-1 { top: 10%; left: 10%; animation-delay: 0s; }
    .banana-2 { top: 20%; right: 15%; animation-delay: 1s; }
    .banana-3 { bottom: 30%; left: 5%; animation-delay: 2s; }
    .banana-4 { bottom: 10%; right: 10%; animation-delay: 0.5s; }

    @media (max-width: 480px) {
      .login-container {
        padding: 30px 20px;
      }
      
      .game-title {
        font-size: 2em;
      }
      
      .welcome-header {
        font-size: 2.5em;
      }
    }
  </style>
</head>
<body>
  <!-- Floating bananas for decoration -->
  <div class="floating-banana banana-1">üçå</div>
  <div class="floating-banana banana-2">üçå</div>
  <div class="floating-banana banana-3">üçå</div>
  <div class="floating-banana banana-4">üçå</div>

  <div class="login-container">
    <div class="welcome-header">üçå</div>
    <h1 class="game-title">Banana Grower</h1>
    
    <div class="tab-container">
      <button class="tab-button active" id="login-tab">Login</button>
      <button class="tab-button" id="signup-tab">Sign Up</button>
    </div>

    <div class="error-message" id="error-message"></div>

    <form id="auth-form">
      <div class="form-title" id="form-title">Sign in to your account</div>
      
      <div class="form-group">
        <label for="email">Email Address</label>
        <input type="email" id="email" name="email" placeholder="Enter your email" required>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" placeholder="Enter your password" required>
      </div>

      <div class="form-group" id="confirm-password-group" style="display: none;">
        <label for="confirm-password">Confirm Password</label>
        <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm your password">
      </div>

      <div class="login-buttons">
        <button type="submit" class="btn btn-primary" id="submit-btn">
          üîë Sign In
        </button>
        
        <a href="../" class="btn btn-back">
          ‚Üê Back to Main Login
        </a>
      </div>
    </form>
    
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <span id="loading-text">Signing you in...</span>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAiNsBnqgY2i1aLzyJEC0YcwDoGJTGYLiM",
      authDomain: "websites-be0b4.firebaseapp.com",
      projectId: "websites-be0b4",
      storageBucket: "websites-be0b4.appspot.com",
      messagingSenderId: "1027369012808",
      appId: "1:1027369012808:web:3d7ed70ba0234ada62d27d"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // DOM elements
    const loginTab = document.getElementById('login-tab');
    const signupTab = document.getElementById('signup-tab');
    const formTitle = document.getElementById('form-title');
    const submitBtn = document.getElementById('submit-btn');
    const confirmPasswordGroup = document.getElementById('confirm-password-group');
    const authForm = document.getElementById('auth-form');
    const loading = document.getElementById('loading');
    const loadingText = document.getElementById('loading-text');
    const errorMessage = document.getElementById('error-message');

    let isLoginMode = true;

    // Tab switching
    loginTab.onclick = () => switchToLogin();
    signupTab.onclick = () => switchToSignup();

    function switchToLogin() {
      isLoginMode = true;
      loginTab.classList.add('active');
      signupTab.classList.remove('active');
      formTitle.textContent = 'Sign in to your account';
      submitBtn.innerHTML = 'üîë Sign In';
      confirmPasswordGroup.style.display = 'none';
      document.getElementById('confirm-password').required = false;
      hideError();
    }

    function switchToSignup() {
      isLoginMode = false;
      signupTab.classList.add('active');
      loginTab.classList.remove('active');
      formTitle.textContent = 'Create your account';
      submitBtn.innerHTML = 'üöÄ Sign Up';
      confirmPasswordGroup.style.display = 'block';
      document.getElementById('confirm-password').required = true;
      hideError();
    }

    function showLoading(text = 'Processing...') {
      authForm.style.display = 'none';
      loading.style.display = 'block';
      loadingText.textContent = text;
    }

    function hideLoading() {
      authForm.style.display = 'block';
      loading.style.display = 'none';
    }

    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.style.display = 'block';
      errorMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function hideError() {
      errorMessage.style.display = 'none';
    }

    function getFirebaseErrorMessage(errorCode) {
      switch (errorCode) {
        case 'auth/user-not-found':
          return 'No account found with this email address.';
        case 'auth/wrong-password':
          return 'Incorrect password. Please try again.';
        case 'auth/email-already-in-use':
          return 'An account with this email already exists.';
        case 'auth/weak-password':
          return 'Password should be at least 6 characters long.';
        case 'auth/invalid-email':
          return 'Please enter a valid email address.';
        case 'auth/too-many-requests':
          return 'Too many failed attempts. Please try again later.';
        default:
          return 'An error occurred. Please try again.';
      }
    }

    // Form submission
    authForm.onsubmit = async (e) => {
      e.preventDefault();
      hideError();

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirm-password').value;

      // Validation
      if (!email || !password) {
        showError('Please fill in all required fields.');
        return;
      }

      if (!isLoginMode) {
        if (password !== confirmPassword) {
          showError('Passwords do not match.');
          return;
        }
        if (password.length < 6) {
          showError('Password must be at least 6 characters long.');
          return;
        }
      }

      try {
        if (isLoginMode) {
          showLoading('Signing you in...');
          await signInWithEmailAndPassword(auth, email, password);
        } else {
          showLoading('Creating your account...');
          await createUserWithEmailAndPassword(auth, email, password);
        }
      } catch (error) {
        hideLoading();
        console.error('Auth error:', error);
        showError(getFirebaseErrorMessage(error.code));
      }
    };

    // Check if user is already logged in
    onAuthStateChanged(auth, (user) => {
      if (user) {
        // Redirect to game page
        showLoading('Redirecting to game...');
        setTimeout(() => {
          window.location.href = '../game';
        }, 1000);
      }
    });

    // Auto-focus email field
    document.getElementById('email').focus();
  </script>
</body>
</html>
